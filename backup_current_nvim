#!/bin/bash
SUFFIX=$1

if [ -z "$SUFFIX" ]; then
    echo "Usage: ./backup_current_nvim <suffix>"
    exit 1
fi

paths=(
    "$HOME/.config/nvim"
    "$HOME/.local/share/nvim"
    "$HOME/.local/state/nvim"
    "$HOME/.cache/nvim"
)

for dir in "${paths[@]}"; do
    if [ -d "$dir" ]; then
        echo "Found $dir. Attempting backup..."
        # If the destination exists, remove it first to avoid permission conflicts
        if [ -d "$dir.$SUFFIX" ]; then
            echo "Warning: $dir.$SUFFIX already exists. Overwriting..."
            sudo rm -rf "$dir.$SUFFIX"
        fi
        
        mv "$dir" "$dir.$SUFFIX"
        echo "Successfully moved to $dir.$SUFFIX"
    else
        echo "Skipping $dir: Not found."
    fi
done